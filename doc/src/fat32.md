# mock1.fat32.img

1. EPBP:     0x200      = 1 * 0x200
2. FAT1:     0x4200     = 0x20  * 0x200 + 0x200
3. CLUSTER2: 0x2F_8600  = 0xBD1 * 0x200 * 2 + 0x4200

# mock3.fat32.img

1. EPBP:     0x80_0000  = 0x4000 * 0x200
2. FAT1:     0x80_4000  = 0x20 * 0x200 + 0x80_0000
3. CLUSTER2: 0xAD_8C00  = 0xB53 * 0x200 * 2 + 0x80_4000

## パーティションテーブル1

```bash
# mock1                                     mock3
80          : bootable                      00          : Not bootable
FE          :                               05          :
FFFF        :                               0501        :
0B          : FAT32                         0B          : FAT32
FE          :                               79
FFFF        :                               2118
01000000    : = 0x01 : 相対セクタ           00400000    : 0x4000
FFFF0500    : = 0x05ffff : 総セクタ数       00C00500    : 0x05C000
```

## パラメタブロック

### mock1

```bash
# mock1
EB5890              :
42534420_20342E34   : "BSD  4.4"
0002                : 0x200 = 512   : セクタあたりバイト数
01                  : 1             : クラスタあたりセクタ数
2000                : 0x20 = 32     : 予約セクタ数
02                  : 2             : FAT数
0000                : 0             : FAT32の場合は0
0000                : 0             : 総セクタ数はオフセット32を使用
F8                  : 0xF8          : FAT ID
0000                : 0             : FAT32の場合は0
2000                : 0x20 = 32     : トラックあたりセクタ数
2000                : 0x20 = 32     : ヘッダ数
01000000            : 1             : パーティション先頭のLbA
FFFF0500            : 0x5ffff = 393,215 : 総セクタ数
D10B0000            : 0xbd1 = 3025  : FATあたりセクタ数
0000                : 0             : フラグ
0000                : 0             : FATバージョン
02000000            : 2             : ルートディレクトリのクラスタ番号
0100                : 1             : FSInfoのセクタ番号
0600                : 6             : バックアップブートセクタのセクタ番号
00000000_00000000_00000000          : 予約
80                  : 0x80          : ハードディスク
00                  : 0x00          : 予約
29                  : 0x29          : シグネチャ
FB075C5D            :               : シリアル番号
4353313430452020202020              : "CS140E     "
4641543332202020                    : "FAT32  "
...
```

### mock3: 0x800000 (0x200 * 0x4000)

```bash
EB5890
6D6B66732E666174    : "mkfs.fat"
0002                : 0x200 = 512   : セクタあたりのバイト数
01                  : 1             : クラスタあたりのセクタ数
2000                : 0x20          : 予約セクタ数
02                  : 2             : FAT数
0000                : 0
0000                : 0
F8                  :
0000                : 0
2000                :
4000
00000000            : 0
00C00500            ; 0x05c000      : 総論理セクタ数
530B0000            : 0xB53         : FATあたりのセクタ数
0000
0000
02000000            : 2             : ルートディレクトリのクラスタ番号
0100
0600                : 6
00000000 00000000 00000000
80                  : 0x80          : ハードディスク
00
29                  : 0x29          : シグネチャ
8DEC157E
4E4F204E 414D4520 202020            : "NO NAME    "
46415433 32202020                   : "FAT32   "

## FAT1, FAT2

### mock1: 0x4200-, 0x17e400

- エントリ 0: `0x0FFFFFF8`
- エントリ 1: `0x0FFFFFFF`
- クラスタ 2-4: `0x0FFFFFFF`
- クラスタ 5: `0x00000006`

```bash
0004200: F8FFFF0F FFFFFF0F FFFFFF0F FFFFFF0F :
0004200: FFFFFF0F 06000000 07000000 08000000
0004200: 09000000 0A000000 0B000000 0C000000
...
0008E00: 01130000 02130000 03130000 FFFFFF0F
0008E10: 05130000 06130000 07130000 08130000
...
00806F0: 3DF10100 3EF10100 3FF10100 40F10100
0080700: FFFFFF0F 00000000 00000000 00000000
```

### mock3: 0x804000

- エントリ 0: `0x0FFFFFF8`
- エントリ 1: `0x0FFFFFFF`
- エントリ 2: `0x0FFFFFF8`
- エントリ 3-: `0x0FFFFFFF`

```bash
F8FFFF0F FFFFFF0F F8FFFF0F FFFFFF0F
FFFFFF0F FFFFFF0F FFFFFF0F FFFFFF0F
FFFFFF0F FFFFFF0F FFFFFF0F FFFFFF0F
FFFFFF0F FFFFFF0F FFFFFF0F FFFFFF0F
FFFFFF0F FFFFFF0F FFFFFF0F FFFFFF0F
FFFFFF0F FFFFFF0F FFFFFF0F FFFFFF0F
19000000 1A000000 1B000000 1C000000
```

### クラスタ 2: 0x2F8600-,

- ルートディレクトリの内容

```bash
43533134 30452020   : "CS140E  "    : ファイル名
202020              : "   "         : 拡張子
28                  : 0x28          :  archive | directory | volume_id
00                  :               : 予約
00                  : 0             : creation_tenth
0000                : 0             : creation_time
0000                : 0             : creation_data
0000                : 0             : accessed_data
0000                : 0             : cluster_high
2A03                :               : modified_time
5A4C                :               : modified_data
0000                : 0
00000000
```

- "rpi3-docs"ディレクトリのLFNエントリ

```bash
41                  - 0b0100_0001   : 最初かつ最後のLFNエントリ、POS=1
7200 7000 6900 3300 2D00            : "r p i 3 - "
0F                  : 0x0f          : LFNエントリ
00                  : 0x00          : VFAT LFN
34                  : 0x34          : checksum
6400 6F00 6300 7300 0000 FFFF       : "d o c s \0
0000                : 0x0000        : 常に0
FFFF FFFF           :
```

- "rpi3-docs"ディレクトリの通常エントリ

```bash
52504933 2D447E31   :               : "RPI3-D~"
202020              :               : "   "
10                  : 0x10          : ディレクトリ
00
0A
2A03                : 0x032a 00000 01_1001 0_1010 : 00-25-10
5A4C                : 0x4c5a 010_0110 0010 1_1010  : 2018-02-26
5A4C
0000                : 0x0           : cluster-high
2A03
5A4C
0300                : 0x3           : cluster-low : クラスタ 3
00000000

# "solutions"ディレクトリのLFNエントリ
4173006F 006C0075 0074000F 00416900 : As o l u t   Ai
6F006E00 73000000 FFFF0000 FFFFFFFF : o n s   ÿÿ  ÿÿÿÿ
# "soltions"ディレクトリの通常エントリ: クラスタ番号: (0x1d0f0 - 2) * 0x200 + 0x2F8600
534F4C55 54497E31 20202010 00252A03 : SOLUTI~1     %*
5A4C5A4C 01002A03 5A4CF0D0 00000000 : ZLZL  * ZLðÐ
# "notes"ディレクトリ: クラスタ番号: (0x1d100 - 2) * 0x200 + 0x2F8600 = 0x3d18200
4E4F5445 53202020 20202010 08252A03 : NOTES        %*
5A4C5A4C 01002A03 5A4C00D1 00000000 : ZLZL  * ZL Ñ
...
```

### クラスタ 3: 0x2F8800-,

- "rpi3-docs"ディレクトリの内容

```bash
# "." ディレクトリ
2E202020 20202020 20202030 000A2A03
5A4C5A4C 00004E01 5A4C0300 00000000
# ".." ディレクトリ
2E2E2020 20202020 20202010 000A2A03
5A4C5A4C 00002A03 5A4C0000 00000000
# "EMMC"ディレクトリ
454D4D43 20202020 20202010 000A2A03
5A4C5A4C 00002A03 5A4C0400 00000000
# "Broadcom"ディレクトリのLFNエントリ
41420072 006F0061 0064000F 008C6300
6F006D00 0000FFFF FFFF0000 FFFFFFFF
# "Broadcom"ディレクトリの通常エントリ
42524F41 44434F4D 20202010 000C2A03
5A4C5A4C 00002A03 5A4CF52C 00000000
# "ARM"ディレクトリ
41524D20 20202020 20202010 000F2A03
5A4C5A4C 00002A03 5A4CE454 00000000
#
E57E3120 20202020 545F4A22 000F2A03
5A4C5A4C 00002901 5A4C4E54 BF2B0100
# "RPi3-Schematics.pdf"ファイルのLFNエントリ2
42                          : 0b0100 0010 : 最後のLFNエントリでpos=2
6300 7300 2E00 7000 6400    : "cs.pd"
0F
00
20
6600 0000 FFFF FFFF FFFF FFFF : "f\0"
0000
FFFF FFFF
# "RPi3-Schematics.pdf"ファイルのLFNエントリ1
01                          : 0b0000 0001 : 最初のLFNエントリでpos=1
5200 5000 6900 3300 2D00    : "Rpi3-
0F
00
20
5300 6300 6800 6500 6D00 6100   : "Schema
0000
7400 6900                       : "ti"
# "RPi3-Schematics.pdf"ファイルの通常エントリ
52504933 2D537E31           : "RPI3-S~1"
504446                      : "PDF"
20                          : アーカイブの通常ファイル
00
0F
2A03
5A4C
5A4C
0000                        : cluster-high
2901
5A4C
4E54                        : cluster-low クラスタ 20052
BF2B0100    : 0x12bbf = 76,735  : ファイルサイズ
...
```

## mock3: ルートディレクトリ (Cluster 2)

```bash
4E4F5445 53202020   : "NOTES   "
202020              : "   "
10
08
00
0005
5A4C
5A4C
0000            : 0 : cluster-high
0005
5A4C
0300            : 3 : Cluster-low  -> クラスタ3
00000000
```

### "notes"ディレクトリ

```bash
# "lec1" : => 8 クラスタ 8
4C454331 20202020 20202010 08000005
5A4C5A4C 00000005 5A4C0800 00000000

# "slide.pdf"の通常エントリ
4534C4944 45532020  : "SLIDES "
504446              : "PDF"
20                  : 通常ファイル(archive)
18
00
0005                : 0x0500 = 0_0000 10_1000 0_0000 = 00-40-00    : creation-time
5A4C                : 0x4c5a = 010_0110 0010 1_1010 = 2018-02-26  : creation-date
5A4C                : 0x4c5a = 2018-02-26                       : accessed-date
0000                : cluser-high
0005                : 0x0500 = 00-40-00                         : modified-time
5A4C                : 0x4c5a = 2018-02-26                       : modified-date
5714                : cluster-low
EF160E00            : 0xe16ef = 923,375 : ファイルサイズ
```

2024-04-29 -> 44-04-29 -> 0101_1000_1001_1101 = 0x589d
2018-02-26 -> 38-02-26 -> 0100_1100_0101_1010 = 0x4c5a
